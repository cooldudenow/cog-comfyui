build:
  gpu: true
  cuda: "12.1"
  system_packages:
    - ffmpeg
    - libgl1-mesa-glx
    - libglib2.0-0
  python_version: "3.11"
  python_requirements: requirements.txt
  run:
    - curl -o /usr/local/bin/pget -L "https://github.com/replicate/pget/releases/latest/download/pget_$(uname -s)_$(uname -m)" && chmod +x /usr/local/bin/pget
    - pip install onnxruntime-gpu --extra-index-url https://aiinfra.pkgs.visualstudio.com/PublicPackages/_packaging/onnxruntime-cuda-12/pypi/simple/
    - pip install torch==2.4.0 torchvision==0.19.0 --index-url https://download.pytorch.org/whl/cu121
    - pip install diffusers==0.34.0 transformers==4.45.2 accelerate safetensors xformers peft ftfy imageio imageio-ffmpeg huggingface-hub==0.34.3
predict: "predict.py:Predictor"
train: "train.py:train"
